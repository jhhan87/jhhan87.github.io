{"version":3,"file":"theme.min.js","sources":["../../../_javascript/theme.js"],"sourcesContent":["/**\n * Theme management class\n *\n * To reduce flickering during page load, this script should be loaded synchronously.\n */\nclass Theme {\n  static #modeKey = 'mode';\n  static #modeAttr = 'data-mode';\n  static #darkMedia = window.matchMedia('(prefers-color-scheme: dark)');\n  static switchable = !document.documentElement.hasAttribute(this.#modeAttr);\n\n  static get DARK() {\n    return 'dark';\n  }\n\n  static get LIGHT() {\n    return 'light';\n  }\n\n  /**\n   * @returns {string} Theme mode identifier\n   */\n  static get ID() {\n    return 'theme-mode';\n  }\n\n  /**\n   * Gets the current visual state of the theme.\n   *\n   * @returns {string} The current visual state, either the mode if it exists,\n   *                   or the system dark mode state ('dark' or 'light').\n   */\n  static get visualState() {\n    if (this.#hasMode) {\n      return this.#mode;\n    } else {\n      return this.#sysDark ? this.DARK : this.LIGHT;\n    }\n  }\n\n  static get #mode() {\n    return (\n      sessionStorage.getItem(this.#modeKey) ||\n      document.documentElement.getAttribute(this.#modeAttr)\n    );\n  }\n\n  static get #isDarkMode() {\n    return this.#mode === this.DARK;\n  }\n\n  static get #hasMode() {\n    return this.#mode !== null;\n  }\n\n  static get #sysDark() {\n    return this.#darkMedia.matches;\n  }\n\n  /**\n   * Maps theme modes to provided values\n   * @param {string} light Value for light mode\n   * @param {string} dark Value for dark mode\n   * @returns {Object} Mapped values\n   */\n  static getThemeMapper(light, dark) {\n    return {\n      [this.LIGHT]: light,\n      [this.DARK]: dark\n    };\n  }\n\n  /**\n   * Initializes the theme based on system preferences or stored mode\n   */\n  static init() {\n    if (!this.switchable) {\n      return;\n    }\n\n    this.#darkMedia.addEventListener('change', () => {\n      const lastMode = this.#mode;\n      this.#clearMode();\n\n      if (lastMode !== this.visualState) {\n        this.#notify();\n      }\n    });\n\n    if (!this.#hasMode) {\n      return;\n    }\n\n    if (this.#isDarkMode) {\n      this.#setDark();\n    } else {\n      this.#setLight();\n    }\n  }\n\n  /**\n   * Flips the current theme mode\n   */\n  static flip() {\n    if (this.#hasMode) {\n      this.#clearMode();\n    } else {\n      this.#sysDark ? this.#setLight() : this.#setDark();\n    }\n    this.#notify();\n  }\n\n  static #setDark() {\n    document.documentElement.setAttribute(this.#modeAttr, this.DARK);\n    sessionStorage.setItem(this.#modeKey, this.DARK);\n  }\n\n  static #setLight() {\n    document.documentElement.setAttribute(this.#modeAttr, this.LIGHT);\n    sessionStorage.setItem(this.#modeKey, this.LIGHT);\n  }\n\n  static #clearMode() {\n    document.documentElement.removeAttribute(this.#modeAttr);\n    sessionStorage.removeItem(this.#modeKey);\n  }\n\n  /**\n   * Notifies other plugins that the theme mode has changed\n   */\n  static #notify() {\n    window.postMessage({ id: this.ID }, '*');\n  }\n}\n\nTheme.init();\n\nexport default Theme;\n"],"names":["Theme","DARK","LIGHT","ID","visualState","_classPrivateGetter","_get_hasMode","_get_mode","_get_sysDark","getThemeMapper","light","dark","init","switchable","_assertClassBrand","_darkMedia","_","addEventListener","lastMode","_clearMode","call","_notify","_get_isDarkMode","_setDark","_setLight","flip","_Theme","_this","sessionStorage","getItem","_modeKey","document","documentElement","getAttribute","_modeAttr","_this2","_this3","_this4","matches","setAttribute","setItem","removeAttribute","removeItem","window","postMessage","id","matchMedia","_defineProperty","hasAttribute"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACA;EACA;EACA,MAAMA,KAAK,CAAC;IAMV,WAAWC,IAAIA,GAAG;EAChB,IAAA,OAAO,MAAM;EACf,EAAA;IAEA,WAAWC,KAAKA,GAAG;EACjB,IAAA,OAAO,OAAO;EAChB,EAAA;;EAEA;EACF;EACA;IACE,WAAWC,EAAEA,GAAG;EACd,IAAA,OAAO,YAAY;EACrB,EAAA;;EAEA;EACF;EACA;EACA;EACA;EACA;IACE,WAAWC,WAAWA,GAAG;MACvB,IAAIC,mBAAA,CA5BFL,KAAK,EA4BH,IAAI,EAACM,YAAO,CAAC,EAAE;EACjB,MAAA,OAAOD,mBAAA,CA7BPL,KAAK,EA6BE,IAAI,EAACO,SAAI,CAAC;EACnB,IAAA,CAAC,MAAM;EACL,MAAA,OAAOF,mBAAA,CA/BPL,KAAK,EA+BE,IAAI,EAACQ,YAAO,CAAC,GAAG,IAAI,CAACP,IAAI,GAAG,IAAI,CAACC,KAAK;EAC/C,IAAA;EACF,EAAA;EAqBA;EACF;EACA;EACA;EACA;EACA;EACE,EAAA,OAAOO,cAAcA,CAACC,KAAK,EAAEC,IAAI,EAAE;MACjC,OAAO;EACL,MAAA,CAAC,IAAI,CAACT,KAAK,GAAGQ,KAAK;QACnB,CAAC,IAAI,CAACT,IAAI,GAAGU;OACd;EACH,EAAA;;EAEA;EACF;EACA;IACE,OAAOC,IAAIA,GAAG;EACZ,IAAA,IAAI,CAAC,IAAI,CAACC,UAAU,EAAE;EACpB,MAAA;EACF,IAAA;EAEAC,IAAAA,iBAAA,CA3EEd,KAAK,EA2EP,IAAI,EAACe,UAAU,CAAA,CAAAC,CAAA,CAACC,gBAAgB,CAAC,QAAQ,EAAE,MAAM;QAC/C,MAAMC,QAAQ,GAAGb,mBAAA,CA5EjBL,KAAK,EA4EY,IAAI,EAACO,SAAI,CAAC;QAC3BO,iBAAA,CA7EAd,KAAK,EA6EL,IAAI,EAACmB,UAAS,CAAC,CAAAC,IAAA,CAAf,IAAI,CAAA;EAEJ,MAAA,IAAIF,QAAQ,KAAK,IAAI,CAACd,WAAW,EAAE;UACjCU,iBAAA,CAhFFd,KAAK,EAgFH,IAAI,EAACqB,OAAM,CAAC,CAAAD,IAAA,CAAZ,IAAI,CAAA;EACN,MAAA;EACF,IAAA,CAAC,CAAC;MAEF,IAAI,CAACf,mBAAA,CApFHL,KAAK,EAoFF,IAAI,EAACM,YAAO,CAAC,EAAE;EAClB,MAAA;EACF,IAAA;MAEA,IAAID,mBAAA,CAxFFL,KAAK,EAwFH,IAAI,EAACsB,eAAU,CAAC,EAAE;QACpBR,iBAAA,CAzFAd,KAAK,EAyFL,IAAI,EAACuB,QAAO,CAAC,CAAAH,IAAA,CAAb,IAAI,CAAA;EACN,IAAA,CAAC,MAAM;QACLN,iBAAA,CA3FAd,KAAK,EA2FL,IAAI,EAACwB,SAAQ,CAAC,CAAAJ,IAAA,CAAd,IAAI,CAAA;EACN,IAAA;EACF,EAAA;;EAEA;EACF;EACA;IACE,OAAOK,IAAIA,GAAG;MACZ,IAAIpB,mBAAA,CAnGFL,KAAK,EAmGH,IAAI,EAACM,YAAO,CAAC,EAAE;QACjBQ,iBAAA,CApGAd,KAAK,EAoGL,IAAI,EAACmB,UAAS,CAAC,CAAAC,IAAA,CAAf,IAAI,CAAA;EACN,IAAA,CAAC,MAAM;EACLf,MAAAA,mBAAA,CAtGAL,KAAK,EAsGL,IAAI,EAACQ,YAAO,CAAC,GAAGM,iBAAA,CAtGhBd,KAAK,EAsGW,IAAI,EAACwB,SAAQ,CAAC,CAAAJ,IAAA,CAAd,IAAI,CAAA,GAAeN,iBAAA,CAtGnCd,KAAK,EAsG8B,IAAI,EAACuB,QAAO,CAAC,CAAAH,IAAA,CAAb,IAAI,CAAW;EACpD,IAAA;MACAN,iBAAA,CAxGEd,KAAK,EAwGP,IAAI,EAACqB,OAAM,CAAC,CAAAD,IAAA,CAAZ,IAAI,CAAA;EACN,EAAA;EAuBF;EAACM,MAAA,GAhIK1B,KAAK;EAAA,SAAAO,SAAAA,CAAAoB,KAAA,EAmCU;EACjB,EAAA,OACEC,cAAc,CAACC,OAAO,CAACf,iBAAA,CArCvBd,MAAK,EAAA2B,KAAA,EAqCuBG,QAAQ,CAAA,CAAAd,CAAA,CAAC,IACrCe,QAAQ,CAACC,eAAe,CAACC,YAAY,CAACnB,iBAAA,CAtCtCd,MAAK,EAAA2B,KAAA,EAsCsCO,SAAS,CAAA,CAAAlB,CAAA,CAAC;EAEzD;EAAC,SAAAM,eAAAA,CAAAa,MAAA,EAEwB;IACvB,OAAO9B,mBAAA,CA3CLL,MAAK,EAAAmC,MAAA,EA2CK5B,SAAI,CAAC,KAAK4B,MAAA,CAAKlC,IAAI;EACjC;EAAC,SAAAK,YAAAA,CAAA8B,MAAA,EAEqB;IACpB,OAAO/B,mBAAA,CA/CLL,MAAK,EAAAoC,MAAA,EA+CK7B,SAAI,CAAC,KAAK,IAAI;EAC5B;EAAC,SAAAC,YAAAA,CAAA6B,MAAA,EAEqB;IACpB,OAAOvB,iBAAA,CAnDLd,MAAK,EAAAqC,MAAA,EAmDKtB,UAAU,CAAA,CAAAC,CAAA,CAACsB,OAAO;EAChC;EAAC,SAAAf,WAuDiB;EAChBQ,EAAAA,QAAQ,CAACC,eAAe,CAACO,YAAY,CAACzB,iBAAA,CA5GpCd,MAAK,EA4G+B,IAAI,EAACkC,SAAS,CAAA,CAAAlB,CAAA,EAAE,IAAI,CAACf,IAAI,CAAC;EAChE2B,EAAAA,cAAc,CAACY,OAAO,CAAC1B,iBAAA,CA7GrBd,MAAK,EA6GgB,IAAI,EAAC8B,QAAQ,EAAAd,CAAA,EAAE,IAAI,CAACf,IAAI,CAAC;EAClD;EAAC,SAAAuB,YAEkB;EACjBO,EAAAA,QAAQ,CAACC,eAAe,CAACO,YAAY,CAACzB,iBAAA,CAjHpCd,MAAK,EAiH+B,IAAI,EAACkC,SAAS,CAAA,CAAAlB,CAAA,EAAE,IAAI,CAACd,KAAK,CAAC;EACjE0B,EAAAA,cAAc,CAACY,OAAO,CAAC1B,iBAAA,CAlHrBd,MAAK,EAkHgB,IAAI,EAAC8B,QAAQ,EAAAd,CAAA,EAAE,IAAI,CAACd,KAAK,CAAC;EACnD;EAAC,SAAAiB,aAEmB;EAClBY,EAAAA,QAAQ,CAACC,eAAe,CAACS,eAAe,CAAC3B,iBAAA,CAtHvCd,MAAK,EAsHkC,IAAI,EAACkC,SAAS,CAAA,CAAAlB,CAAA,CAAC;EACxDY,EAAAA,cAAc,CAACc,UAAU,CAAC5B,iBAAA,CAvHxBd,MAAK,EAuHmB,IAAI,EAAC8B,QAAQ,CAAA,CAAAd,CAAA,CAAC;EAC1C;EAEA;EACF;EACA;EAFE,SAAAK,UAGiB;IACfsB,MAAM,CAACC,WAAW,CAAC;MAAEC,EAAE,EAAE,IAAI,CAAC1C;KAAI,EAAE,GAAG,CAAC;EAC1C;EAAC,IAAA2B,QAAA,GAAA;EAAAd,EAAAA,CAAA,EA9HiB;EAAM,CAAA;EAAA,IAAAkB,SAAA,GAAA;EAAAlB,EAAAA,CAAA,EACL;EAAW,CAAA;EAAA,IAAAD,UAAA,GAAA;EAAAC,EAAAA,CAAA,EACV2B,MAAM,CAACG,UAAU,CAAC,8BAA8B;EAAC,CAAA;EAAAC,eAAA,CAHjE/C,KAAK,EAAA,YAAA,EAIW,CAAC+B,QAAQ,CAACC,eAAe,CAACgB,YAAY,CAAClC,iBAAA,CAJvDd,MAAK,EAAA0B,MAAA,EAIuDQ,SAAS,CAAA,CAAAlB,CAAA,CAAC,CAAA;EA8H5EhB,KAAK,CAACY,IAAI,EAAE;;;;;;;;"}